<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5M07SFV1BF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5M07SFV1BF');
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USAF AI Performance Statement Refinery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Custom Styles for a Sleek, Modern Refresh --- */
        :root {
            --bg-dark: #09090b;
            --card-bg: rgba(39, 39, 42, 0.5);
            --border-color: rgba(161, 161, 170, 0.2);
            --text-primary: #e4e4e7;
            --text-secondary: #a1a1aa;
            --primary-purple: #a855f7;
            --primary-cyan: #22d3ee;
            --accent-purple-muted: #c084fc;
            --input-bg: rgba(24, 24, 27, 0.7);
            --success-color: #2ecc71;
            --danger-color: #ef4444;
        }
        
        html[data-theme='light'] {
            --bg-dark: #fafafa;
            --card-bg: rgba(255, 255, 255, 0.8);
            --border-color: #d4d4d8;
            --text-primary: #18181b;
            --text-secondary: #71717a;
            --input-bg: #e4e4e7;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            background-image: radial-gradient(ellipse at top, rgba(168, 85, 247, 0.1), transparent 60%);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- Sticky Header --- */
        .header {
            position: sticky;
            top: 0;
            z-index: 50;
            width: 100%;
            border-bottom: 1px solid var(--border-color);
            background-color: rgba(9, 9, 11, 0.8);
            backdrop-filter: blur(8px);
            padding: 0 1rem;
        }
        html[data-theme='light'] .header {
            background-color: rgba(255, 255, 255, 0.8);
        }
        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            height: 4rem;
            align-items: center;
            justify-content: space-between;
        }
        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .logo {
            height: 2.5rem;
            width: auto;
        }
        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-purple), var(--primary-cyan));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .theme-toggle-btn {
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 1rem;
        }
        .theme-toggle-btn:hover {
            border-color: var(--primary-purple);
            color: var(--text-primary);
        }
        .theme-toggle-btn svg { width: 1.25rem; height: 1.25rem; }


        /* Gradient Header Text for the main title */
        h1.main-title {
            background: linear-gradient(to right, var(--text-primary), var(--accent-purple-muted));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* --- Card Styles --- */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            margin-bottom: 2rem;
        }
        .card-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 1.125rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .card-body {
            padding: 1.5rem;
        }

        /* --- Form & Input Styles --- */
        .form-group {
            margin-bottom: 1.5rem;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-secondary);
        }
        input[type="text"], textarea {
            width: 100%;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: all 0.2s ease;
        }
        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.2);
        }
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        .custom-picker-input, .custom-dropdown-selected {
             background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: all 0.2s ease;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .custom-picker-input:hover, .custom-dropdown-selected:hover {
            border-color: var(--primary-purple);
        }
        
        .custom-picker-input::after, .custom-dropdown-selected::after {
            content: 'â–¼';
            font-size: 0.6rem;
            color: var(--text-secondary);
        }
        .floating-dropdown-options {
            position: absolute;
            background-color: #18181b;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            max-height: 500px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        html[data-theme='light'] .floating-dropdown-options {
             background-color: #ffffff;
        }
        .floating-dropdown-option {
            padding: 0.5rem 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .floating-dropdown-option:hover {
            background-color: rgba(168, 85, 247, 0.1);
        }
        .floating-dropdown-option.selected {
            background-color: rgba(168, 85, 247, 0.2);
            font-weight: 600;
        }

        /* --- Button Styles --- */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .btn-primary {
            background: linear-gradient(to right, var(--primary-purple), var(--primary-cyan));
            color: white;
        }
        .btn-primary:hover {
            opacity: 0.9;
        }
        .btn-success {
             background-color: var(--success-color);
             color: white;
        }
        .btn-success:hover {
            opacity: 0.9;
        }
        .btn-danger {
            background: transparent;
            border: 1px solid var(--danger-color);
            color: var(--danger-color);
        }
        .btn-danger:hover {
            background: rgba(239, 68, 68, 0.1);
        }
        .btn-ghost {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }
        .btn-ghost:hover {
            background: var(--input-bg);
            border-color: var(--text-secondary);
        }


        /* --- ALQ Checkbox Styles --- */
        .alq-container {
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
        }
        .alq-group {
            margin-bottom: 1.5rem;
        }
        .alq-header {
            color: var(--text-primary);
            margin-top: 0;
            margin-bottom: 1rem;
            font-weight: 600;
            font-size: 1.1rem;
        }
        .alq-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        .alq-option {
            position: relative;
        }
        .alq-checkbox {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        .alq-label {
            display: flex;
            align-items: center;
            background-color: var(--input-bg);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }
        .alq-option input[type="checkbox"]:checked ~ .alq-label {
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.2);
        }
        .alq-checkmark {
            display: inline-block;
            width: 18px;
            height: 18px;
            background-color: transparent;
            border: 2px solid var(--text-secondary);
            border-radius: 4px;
            margin-right: 10px;
            position: relative;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        .alq-option input[type="checkbox"]:checked ~ .alq-label .alq-checkmark {
            background-color: var(--primary-purple);
            border-color: var(--primary-purple);
        }
        .alq-option input[type="checkbox"]:checked ~ .alq-label .alq-checkmark::after {
            content: '';
            position: absolute;
            display: block;
            top: 2px;
            left: 5px;
            width: 4px;
            height: 8px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        
        /* START: Added CSS for Interactive Mode Toggle */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
        }
        .toggle-checkbox {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 34px;
            transition: .4s;
        }
        .toggle-label:before {
			position: absolute;
			content: "";
			height: 20px;
			width: 20px;
			left: 4px;
			top: 50%;
			transform: translateY(-50%);
			background-color: var(--text-secondary);
			border-radius: 50%;
			transition: .4s;
		}
        .toggle-checkbox:checked + .toggle-label {
            background: linear-gradient(to right, var(--primary-purple), var(--primary-cyan));
            border-color: var(--primary-purple);
        }
        .toggle-checkbox:checked + .toggle-label:before {
            transform: translateX(22px) translateY(-50%);
            background-color: white;
        }
        /* END: Added CSS */

        /* --- Other Styles --- */
        .toggle-section {
            background: none;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            opacity: 0.7;
        }
        .toggle-section:hover {
            opacity: 1;
            background-color: rgba(168, 85, 247, 0.1);
        }
        .reference-section {
            background-color: rgba(168, 85, 247, 0.05);
            border-left: 4px solid var(--primary-purple);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 0 0.5rem 0.5rem 0;
        }
        .example-box {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: var(--input-bg);
            border-left: 3px solid var(--primary-cyan);
            border-radius: 0 0.5rem 0.5rem 0;
        }
        .alq-desc-btn {
            background: none;
            border: none;
            color: var(--primary-purple);
            cursor: pointer;
            font-size: 0.9rem;
            text-decoration: underline;
            padding: 0;
            margin-top: 1rem;
            transition: color 0.2s;
            display: inline-block;
        }
        .alq-desc-btn:hover {
            color: var(--primary-cyan);
        }
        .alq-desc-container {
            margin-top: 1rem;
            padding: 1rem;
            background-color: rgba(168, 85, 247, 0.05);
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
        }
        .ai-resource-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to right, var(--primary-purple), var(--primary-cyan));
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s;
            margin: 0 0.5rem;
            min-width: 150px;
        }
        .ai-resource-link:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        .ai-resource-icon {
            margin-right: 0.5rem;
            font-size: 1.2em;
        }
        .button-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .description-text {
            text-align: center;
            margin: 1rem 0;
            color: var(--text-secondary);
        }
        .output-box {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            white-space: pre-wrap;
            font-family: 'Menlo', 'Monaco', monospace;
            font-size: 0.9rem;
            max-height: 400px;
            overflow-y: auto;
            color: var(--text-primary);
        }
        .hidden { display: none; }
        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
        }
        
        /* --- Picker Modal Styles (Mobile) --- */
        .picker-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            padding: 1rem;
        }
        .picker-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .picker-modal {
            background-color: #18181b;
            border-radius: 1rem;
            width: 100%;
            max-width: 28rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            transform: scale(0.95);
            transition: transform 0.3s;
            display: flex;
            flex-direction: column;
            max-height: 90vh;
        }
        html[data-theme='light'] .picker-modal {
            background-color: #ffffff;
        }
        .picker-overlay.visible .picker-modal {
            transform: scale(1);
        }
        .picker-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        #picker-search-input {
            width: 100%;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
        }
        #picker-search-input:focus {
            outline: none;
            border-color: var(--primary-purple);
        }
        .picker-options-list {
            list-style: none;
            padding: 0.5rem;
            margin: 0;
            overflow-y: auto;
        }
        .picker-option-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        .picker-option-item:hover {
            background-color: rgba(168, 85, 247, 0.1);
        }

        /* --- Reset Confirmation Modal --- */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: #18181b;
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 2rem;
            width: 90%;
            max-width: 450px;
            transform: scale(0.95);
            transition: transform 0.3s;
        }
        html[data-theme='light'] .modal-content {
            background-color: #ffffff;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        .modal-body {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <a href="https://royal-spark.github.io/Landing-Page/" style="text-decoration: none;">
				<div class="logo-container">
					<img src="https://dwtymuzolmglgyejxuve.supabase.co/storage/v1/object/public/podcasts//Royal%20Spark%20D%20Logo%20-%20Mekvold%20V3.png" alt="Royal Spark Logo" class="logo">
					<span class="logo-text">Royal Spark</span>
				</div>
			</a>
            <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle theme">
                <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-1.5 0V3a.75.75 0 0 1 .75-.75ZM7.5 12a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM18.894 6.106a.75.75 0 0 1 0 1.06l-1.591 1.59a.75.75 0 1 1-1.06-1.06l1.59-1.59a.75.75 0 0 1 1.06 0ZM21.75 12a.75.75 0 0 1-.75.75h-2.25a.75.75 0 0 1 0-1.5h2.25a.75.75 0 0 1 .75.75ZM17.894 17.894a.75.75 0 0 1-1.06 0l-1.59-1.591a.75.75 0 1 1 1.06-1.06l1.59 1.59a.75.75 0 0 1 0 1.061ZM12 18.75a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-1.5 0v-2.25a.75.75 0 0 1 .75-.75ZM5.106 17.894a.75.75 0 0 1 0-1.06l1.59-1.591a.75.75 0 1 1 1.06 1.06l-1.59 1.59a.75.75 0 0 1-1.06 0ZM4.5 12a.75.75 0 0 1-.75.75H1.5a.75.75 0 0 1 0-1.5h2.25a.75.75 0 0 1 .75.75ZM6.106 5.106a.75.75 0 0 1 1.06 0l1.59 1.591a.75.75 0 0 1-1.06 1.06l-1.59-1.59a.75.75 0 0 1 0-1.061Z" /></svg>
                <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.981A10.503 10.503 0 0 1 18 19.5a10.5 10.5 0 0 1-10.5-10.5A10.503 10.503 0 0 1 9.528 1.718Z" clip-rule="evenodd" /></svg>
            </button>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 sm:px-6 pb-6 pt-8">
        <div class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold main-title">USAF AI Performance Statement Refinery</h1>
            <p class="text-sm text-slate-400 mt-1">Turn accomplishments into powerful performance statements.</p>
        </div>

        <div class="card">
            <div class="card-header">
                <span>How to Use This Tool</span>
                <button id="howToUseToggle" class="toggle-section">â“˜ Show Instructions</button>
            </div>
            <div id="howToUseBody" class="card-body hidden">
                <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">Purpose: Get 80% of your performance statements done in minutes!</h2>
                <p style="margin-bottom: 1rem;">Our AI tool empowers every Airman to rapidly turn their accomplishments into strong, AFI-structured performance statements. This saves time for both Airmen and supervisors, leading to faster, higher-quality 1206s.</p>
                <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">Step-by-Step Guide:</h2>
                <ol style="list-style: decimal; padding-left: 1.5rem; line-height: 1.8;">
                    <li><strong>Step 1:</strong> Input Your Accomplishments: Simply type in all your details and "word vomit" your achievements.</li>
                    <li><strong>Step 2:</strong> Generate Prompt: Click the "generate prompt" button to create your AI-ready text.</li>
                    <li><strong>Step 3:</strong> Paste & Generate: Copy the prompt and paste it into NIPRGPT or ASK SAGE to get 7 drafted performance statements.</li>
                    <li><strong>Step 4:</strong> Select & Refine: Review the 7 AI-generated statements and select the best parts to provide to your supervisor.</li>
                    <li><strong>Step 5:</strong> Supervisor Review: Your supervisor refines the chosen statements for final perfection.</li>
                </ol>
                <p style="text-align: center; margin-top: 1.5rem;">That's it! Get high-quality, AFI-structured performance statements in minutes.</p>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <span>Input Information</span>
                <button id="toggleReference" class="toggle-section">â“˜ Show Guidance</button>
            </div>
            <div id="referenceSection" class="reference-section hidden">
                <h3 style="font-weight: 600; margin-bottom: 1rem; color: var(--text-primary);">Official USAF Performance Statement Guidance:</h3>
                <p style="margin-bottom: 1rem;">Performance Statements are the AF narrative-style of writing to communicate performance on the AF Form 1206, Nomination for Award (13 Mar 2024). They are efficient, increase clarity, and improve the ability to understand an Airman's performance correctly and equitably.</p>
                
                <h4 style="font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.75rem;">Two Basic Principles:</h4>
                <ul style="list-style: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                    <li><strong>Standalone:</strong> Each Performance Statement is a standalone sentence and includes 1) action and 2) at least one of the following: impact or results/outcome.</li>
                    <li><strong>Readability:</strong> Performance Statements are plain language and avoid using uncommon acronyms and abbreviations.</li>
                </ul>
                
                <h4 style="font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.75rem;">Format:</h4>
                <ul style="list-style: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                    <li>AF Form 1206, Nomination for Award (13 Mar 2024) remains the standard</li>
                    <li>White space on the right margin is both accepted and expected</li>
                    <li>No award nomination criteria may exceed one full page</li>
                    <li>Bullets are not authorized</li>
                </ul>
                
                <div class="example-box">
                    <h4 style="font-weight: 600; margin-bottom: 0.75rem;">Example:</h4>
                    <p><strong>Action and Impact or Results/Outcome:</strong></p>
                    <p>Capt Snuffy <strong>led</strong> a survey team of 33 MCA to establish an XAB in support of a PACAF ACE exercise across 4 countries and including 7 allies, <strong>culminating</strong> in 153 sorties and 334 training events completed. She also <strong>championed</strong> a critical organizational merger of the squadron's maintenance and operations; results <strong>saved</strong> 360 maintenance workhours per week and <strong>increased</strong> sortie generation by 10%.</p>
                </div>
            </div>
            <div class="card-body">
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label for="jobTitleContainer">Job Title/AFSC:</label>
                        <div id="jobTitleContainer"></div>
                    </div>
					<div class="form-group">
						<label for="rankContainer">Rank:</label>
						<div id="rankContainer"></div>
					</div>
                    <div id="otherJobField" class="form-group hidden">
                        <label for="otherJobTitle">Specify Job Title:</label>
                        <input type="text" id="otherJobTitle" placeholder="e.g., Program Manager">
                    </div>
                     <div class="form-group">
                        <label for="majcomContainer">MAJCOM:</label>
                        <div id="majcomContainer"></div>
                    </div>
                    <div class="form-group">
                        <label for="mgaContainer">Major Graded Area (MGA):</label>
                        <div id="mgaContainer"></div>
                    </div>
                    <div class="form-group">
                        <label for="purposeContainer">Purpose:</label>
                        <div id="purposeContainer"></div>
                    </div>
					<div class="form-group flex items-center justify-between bg-transparent p-4 rounded-lg border border-dashed" style="border-color: var(--border-color);">
                    <div class="flex flex-col">
                         <label for="interactiveModeToggle" class="mb-1 font-semibold" style="color: var(--text-primary);">Enable Interactive Mode</label>
                         <p class="text-xs" style="color: var(--text-secondary);">Let the AI ask you questions to build the statement.</p>
                    </div>
                    <div class="toggle-switch">
                        <input type="checkbox" id="interactiveModeToggle" class="toggle-checkbox">
                        <label for="interactiveModeToggle" class="toggle-label"></label>
                    </div>
                </div>
                </div>
				
                <div class="form-group">
                    <label for="accomplishment">Accomplishment Details:</label>
                    <textarea id="accomplishment" placeholder="Describe what you did with metrics in any format: bullet points, notes, sentences, or even stream of consciousness."></textarea>
                </div>
                <div class="form-group">
                    <label>Airman Leadership Qualities (Select up to 3):</label>
                    <div class="alq-container">
                        <div class="alq-group">
                            <h4 class="alq-header">Executing the Mission</h4>
                            <div class="alq-options">
                                <div class="alq-option">
                                    <input type="checkbox" id="alq1" name="alq" value="Job Proficiency" class="alq-checkbox">
                                    <label for="alq1" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Job Proficiency</span>
                                    </label>
                                </div>
                                <div class="alq-option">
                                    <input type="checkbox" id="alq2" name="alq" value="Initiative" class="alq-checkbox">
                                    <label for="alq2" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Initiative</span>
                                    </label>
                                </div>
                                <div class="alq-option">
                                    <input type="checkbox" id="alq3" name="alq" value="Adaptability" class="alq-checkbox">
                                    <label for="alq3" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Adaptability</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="alq-group">
                            <h4 class="alq-header">Leading People</h4>
                            <div class="alq-options">
                                <div class="alq-option">
                                    <input type="checkbox" id="alq4" name="alq" value="Inclusion & Teamwork" class="alq-checkbox">
                                    <label for="alq4" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Inclusion & Teamwork</span>
                                    </label>
                                </div>
                                <div class="alq-option">
                                    <input type="checkbox" id="alq5" name="alq" value="Emotional Intelligence" class="alq-checkbox">
                                    <label for="alq5" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Emotional Intelligence</span>
                                    </label>
                                </div>
                                <div class="alq-option">
                                    <input type="checkbox" id="alq6" name="alq" value="Communication" class="alq-checkbox">
                                    <label for="alq6" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Communication</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="alq-group">
                            <h4 class="alq-header">Managing Resources</h4>
                            <div class="alq-options">
                                <div class="alq-option">
                                    <input type="checkbox" id="alq7" name="alq" value="Stewardship" class="alq-checkbox">
                                    <label for="alq7" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Stewardship</span>
                                    </label>
                                </div>
                                <div class="alq-option">
                                    <input type="checkbox" id="alq8" name="alq" value="Accountability" class="alq-checkbox">
                                    <label for="alq8" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Accountability</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="alq-group">
                            <h4 class="alq-header">Improving the Unit</h4>
                            <div class="alq-options">
                                <div class="alq-option">
                                    <input type="checkbox" id="alq9" name="alq" value="Decision Making" class="alq-checkbox">
                                    <label for="alq9" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Decision Making</span>
                                    </label>
                                </div>
                                <div class="alq-option">
                                    <input type="checkbox" id="alq10" name="alq" value="Innovation" class="alq-checkbox">
                                    <label for="alq10" class="alq-label">
                                        <span class="alq-checkmark"></span>
                                        <span>Innovation</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
						<div class="card-header">
							<span> </span>
							<button id="toggleAlqDescriptions" class="toggle-section">â“˜ Show ALQ Descriptions</button>
						</div>
						
                        <div id="alqDescriptions" class="hidden alq-desc-container">
                            <h4 style="font-weight: 600; margin-bottom: 1rem; color: var(--text-primary);">Airman Leadership Quality Definitions</h4>
                            <ul style="list-style: disc; padding-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Job Proficiency:</strong> Demonstrates technical expertise and excels in performing assigned duties.</li>
                                <li><strong>Initiative:</strong> Takes proactive action to seize opportunities without needing direction.</li>
                                <li><strong>Adaptability:</strong> Adjusts to changing conditions and maintains performance under pressure.</li>
                                <li><strong>Inclusion & Teamwork:</strong> Fosters collaboration and values diverse perspectives.</li>
                                <li><strong>Emotional Intelligence:</strong> Recognizes and manages personal emotions and those of others.</li>
                                <li><strong>Communication:</strong> Conveys ideas clearly and effectively at all organizational levels.</li>
                                <li><strong>Stewardship:</strong> Responsibly manages time, money, equipment, and personnel.</li>
                                <li><strong>Accountability:</strong> Takes ownership of actions and ensures tasks are completed to expectation.</li>
                                <li><strong>Decision Making:</strong> Analyzes situations and makes sound, timely choices.</li>
                                <li><strong>Innovation:</strong> Seeks creative solutions and implements improvements to enhance processes.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <button id="generateButton" class="btn btn-primary">Generate & Copy Prompt</button>
            </div>
        </div>

        <div id="outputContainer" class="card hidden">
            <div class="card-header">
                <span>Generated AI Prompt (for debugging)</span>
            </div>
            <div class="card-body">
                <div id="outputPrompt" class="output-box"></div>
            </div>
        </div>
		
		<div class="card">
            <div class="card-header">
                <span>Performance Statement Character Count</span>
            </div>
            <div class="card-body">
                <div class="flex flex-col md:flex-row items-center gap-6">
                    <textarea 
                        id="charCounterTextBox"
                        class="w-full h-32 p-4 rounded-lg text-lg transition duration-300 resize-y"
                        placeholder="Paste text or type here to quickly check and revise with a live character count reading..."
                        style="background-color: var(--input-bg); border: 1px solid var(--border-color); color: var(--text-primary);"
                    ></textarea>

                    <div class="flex flex-col items-center justify-center p-4">
                        <span id="charCounterCount" class="text-7xl font-bold transition-colors duration-300" style="color: var(--primary-cyan);">0</span>
                        <span class="text-sm uppercase tracking-wider" style="color: var(--text-secondary);">Characters</span>
                    </div>
                </div>
            </div>
        </div>
		
        <div id="aiResourcesCard" class="card">
            <div class="card-header">
                <span>AI Resources</span>
            </div>
            <div class="card-body">
                <p class="description-text">
                    Your prompt has been copied. Paste it into NIPRGPT or ASK SAGE.
                </p>
                <div class="button-group">
                    <a href="https://niprgpt.mil/" target="_blank" rel="noopener noreferrer" class="ai-resource-link">
                        <span class="ai-resource-icon">ðŸ¤–</span>
                        NIPRGPT
                    </a>
                    <a href="https://chat.asksage.mil" target="_blank" rel="noopener noreferrer" class="ai-resource-link">
                        <span class="ai-resource-icon">ðŸ’¬</span>
                        ASK SAGE
                    </a>
                </div>
                <p class="description-text">
                    Use NIPRGPT with Gemini 2.5 Pro or Anthropic Claude 4 for best results.
                </p>
            </div>
        </div>
        
        <div class="text-center mt-8">
            <button id="resetBtn" class="btn btn-danger">Reset Tool</button>
        </div>
    </main>

    <footer>
        USAF Performance Statement AI Prompt Generator | For official use only
    </footer>
    
   <div id="picker-overlay" class="picker-overlay">
        <div class="picker-modal">
            <div class="picker-header">
                <input type="text" id="picker-search-input" placeholder="Type to search...">
            </div>
            <ul id="picker-options-list" class="picker-options-list">
                </ul>
        </div>
    </div>
    
    <div id="confirmation-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">Are you sure?</h3>
            <p class="modal-body">This will clear all inputs and generated content. This action cannot be undone.</p>
            <div class="modal-actions">
                <button id="cancel-reset" class="btn btn-ghost">Cancel</button>
                <button id="confirm-reset" class="btn btn-danger">Confirm Reset</button>
            </div>
        </div>
    </div>
    
    <div id="alert-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="alert-title" class="modal-title">Input Required</h3>
            <p id="alert-body" class="modal-body">Please fill in all required fields before generating a prompt.</p>
            <div class="modal-actions">
                <button id="alert-ok" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>

    <script>
      // === Device Detection ===
      const isTouchDevice = window.matchMedia("(pointer: coarse)").matches;

      // === Data ===
      const afscOptions = [
        { text: '-- Select Your AFSC/Job Title --', value: '' },
        { text: 'DOD Government Civilian', value: 'DOD Government Civilian' },
        { text: '11S - Special Operations Pilot', value: '11S - Special Operations Pilot' },
        { text: '12S - Special Operations Combat Systems Officer', value: '12S - Special Operations Combat Systems Officer' },
        { text: '14F - Information Operations Officer', value: '14F - Information Operations Officer' },
        { text: '14N - Intelligence Officer', value: '14N - Intelligence Officer' },
        { text: '15W - Weather Officer', value: '15W - Weather Officer' },
        { text: '17S - Cyberspace Operations Officer', value: '17S - Cyberspace Operations Officer' },
        { text: '17D - Cyberspace Operations Officer', value: '17D - Cyberspace Operations Officer' },
        { text: '18S - Special Reconnaissance Officer', value: '18S - Special Reconnaissance Officer' },
        { text: '19Z - Special Warfare Officer', value: '19Z - Special Warfare Officer' },
        { text: '21A - Aircraft Maintenance Officer', value: '21A - Aircraft Maintenance Officer' },
        { text: '21R - Logistics Readiness Officer', value: '21R - Logistics Readiness Officer' },
        { text: '31P - Security Forces Officer', value: '31P - Security Forces Officer' },
        { text: '32E - Civil Engineer', value: '32E - Civil Engineer' },
        { text: '35P - Public Affairs Officer', value: '35P - Public Affairs Officer' },
        { text: '38F - Force Support Officer', value: '38F - Force Support Officer' },
        { text: '41A - Health Services Administrator', value: '41A - Health Services Administrator' },
        { text: '51J - Judge Advocate', value: '51J - Judge Advocate' },
        { text: '52R - Chaplain', value: '52R - Chaplain' },
        { text: '65F - Financial Management Officer', value: '65F - Financial Management Officer' },
        { text: '87I - Contracting Officer', value: '87I - Contracting Officer' },
        { text: '9E0 - Logistics Readiness Officer', value: '9E0 - Logistics Readiness Officer' },
        { text: '1A1 - Career Enlisted Aviator', value: '1A1 - Career Enlisted Aviator' },
        { text: '1B4 - Cyber Warfare Operations', value: '1B4 - Cyber Warfare Operations' },
        { text: '1C0 - Aviation Resource Management', value: '1C0 - Aviation Resource Management' },
        { text: '1C1 - Air Traffic Control', value: '1C1 - Air Traffic Control' },
        { text: '1C3 - Command and Control Operations', value: '1C3 - Command and Control Operations' },
        { text: '1C5 - Battle Management Operations', value: '1C5 - Battle Management Operations' },
        { text: '1C8 - Radar, Airfield & Weather Systems', value: '1C8 - Radar, Airfield & Weather Systems' },
        { text: '1D7 - Cyber Defense Operations', value: '1D7 - Cyber Defense Operations' },
        { text: '1N0 - All-Source Intelligence Analyst', value: '1N0 - All-Source Intelligence Analyst' },
        { text: '1N1 - Geospatial Intelligence', value: '1N1 - Geospatial Intelligence' },
        { text: '1N2 - Signals Intelligence Analyst', value: '1N2 - Signals Intelligence Analyst' },
        { text: '1N4 - Fusion Analyst', value: '1N4 - Fusion Analyst' },
        { text: '1N7 - Human Intelligence Specialist', value: '1N7 - Human Intelligence Specialist' },
        { text: '1P0 - Aircrew Flight Equipment', value: '1P0 - Aircrew Flight Equipment' },
        { text: '1S0 - Safety', value: '1S0 - Safety' },
        { text: '1T0 - Survival, Evasion, Resistance & Escape (SERE) Specialist', value: '1T0 - Survival, Evasion, Resistance & Escape (SERE) Specialist' },
        { text: '1W0 - Weather', value: '1W0 - Weather' },
        { text: '1Z1 - Pararescue', value: '1Z1 - Pararescue' },
        { text: '1Z2 - Combat Control', value: '1Z2 - Combat Control' },
        { text: '1Z3 - TACP', value: '1Z3 - TACP' },
        { text: '1Z4 - Special Reconnaissance', value: '1Z4 - Special Reconnaissance' },
        { text: '2A3 - Acft Mx', value: '2A3 - Acft Mx' },
        { text: '2A5 - Aerospace Maintenance', value: '2A5 - Aerospace Maintenance' },
        { text: '2A6 - Aircraft Maintenance', value: '2A6 - Aircraft Maintenance' },
        { text: '2A7 - Combined Low Observable and Acft Structual Mx', value: '2A7 - Combined Low Observable and Acft Structual Mx' },
		{ text: '2A7X2 - Nondestructive Inspection', value: '2A7X2 - Nondestructive Inspection' },
        { text: '2A9 - Aerospace Maintenance (Non-Destructive Inspection)', value: '2A9 - Aerospace Maintenance (Non-Destructive Inspection)' },
        { text: '2G0 - Logistics Plans', value: '2G0 - Logistics Plans' },
        { text: '2R2 - Maintenance Management', value: '2R2 - Maintenance Management' },
        { text: '2S0 - Materiel Management', value: '2S0 - Materiel Management' },
        { text: '2T0 - Traffic Management Operations', value: '2T0 - Traffic Management Operations' },
        { text: '2T1 - Ground Transportation', value: '2T1 - Ground Transportation' },
        { text: '2T2 - Air Transportation', value: '2T2 - Air Transportation' },
        { text: '2T3X1 - Vehicle Maintenance', value: '2T3X1 - Vehicle Maintenance' },
        { text: '2T3X7 - Vehicle Fleet Management', value: '2T3X7 - Vehicle Fleet Management' },
        { text: '2W0 - Munitions Systems', value: '2W0 - Munitions Systems' },
        { text: '2W1 - Aircraft Armament Systems', value: '2W1 - Aircraft Armament Systems' },
        { text: '3E0 - Electrical Systems', value: '3E0 - Electrical Systems' },
        { text: '3E1 - Heating, Ventilation, AC, and Refrigeration', value: '3E1 - Heating, Ventilation, AC, and Refrigeration' },
        { text: '3E2 - Heavy Equipment', value: '3E2 - Heavy Equipment' },
        { text: '3E3 - Structures', value: '3E3 - Structures' },
        { text: '3E4 - Pest Management', value: '3E4 - Pest Management' },
        { text: '3E5 - Engineering', value: '3E5 - Engineering' },
        { text: '3E6 - Operations Management', value: '3E6 - Operations Management' },
        { text: '3E7 - Fire Protection', value: '3E7 - Fire Protection' },
        { text: '3E8 - Explosive Ordnance Disposal', value: '3E8 - Explosive Ordnance Disposal' },
        { text: '3E9 - Emergency Management', value: '3E9 - Emergency Management' },
        { text: '3F0 - Personnel', value: '3F0 - Personnel' },
        { text: '3F1 - Services', value: '3F1 - Services' },
        { text: '3F2 - Education and Training', value: '3F2 - Education and Training' },
        { text: '3F3 - Manpower', value: '3F3 - Manpower' },
        { text: '3F4 - Equal Opportunity', value: '3F4 - Equal Opportunity' },
        { text: '3F5 - Administration', value: '3F5 - Administration' },
        { text: '3N0 - Public Affairs', value: '3N0 - Public Affairs' },
        { text: '3N1 - Regional Bands', value: '3N1 - Regional Bands' },
        { text: '3P0 - Security Forces', value: '3P0 - Security Forces' },
        { text: '4A1 - Medical Materiel', value: '4A1 - Medical Materiel' },
        { text: '4B0 - Bioenvironmental Engineering', value: '4B0 - Bioenvironmental Engineering' },
        { text: '4N0 - Aerospace Medical Service', value: '4N0 - Aerospace Medical Service' },
        { text: '4R0 - Radiology', value: '4R0 - Radiology' },
        { text: '5J0 - Paralegal', value: '5J0 - Paralegal' },
        { text: '5R0 - Chaplain Assistant', value: '5R0 - Chaplain Assistant' },
        { text: '6F0 - Financial Management and Comptroller', value: '6F0 - Financial Management and Comptroller' },
        { text: '7S - OSI Enlisted', value: '7S - OSI Enlisted' },
        { text: '8C000 - MFR NCO', value: '8C000 - MFR NCO' },
        { text: '8F0 - First Sergeant', value: '8F0 - First Sergeant' },
        { text: '8H000 - Airman Dorm Leader', value: '8H000 - Airman Dorm Leader' },
        { text: '8I0 - Inspector General', value: '8I0 - Inspector General' },
        { text: '8R - Recruiters', value: '8R - Recruiters' },
        { text: '8T000 - Professional Military Education Instructor', value: '8T000 - Professional Military Education Instructor' },
        { text: 'Other (Specify Below)', value: 'other' }
      ];
		const rankOptions = [
			{ text: '-- Select Rank --', value: '' },
			{ text: 'E-1 Airman Basic', value: 'E-1 Airman Basic' },
			{ text: 'E-2 Airman', value: 'E-2 Airman' },
			{ text: 'E-3 Airman First Class', value: 'E-3 Airman First Class' },
			{ text: 'E-4 Senior Airman', value: 'E-4 Senior Airman' },
			{ text: 'E-5 Staff Sergeant', value: 'E-5 Staff Sergeant' },
			{ text: 'E-6 Technical Sergeant', value: 'E-6 Technical Sergeant' },
			{ text: 'E-7 Master Sergeant', value: 'E-7 Master Sergeant' },
			{ text: 'E-8 Senior Master Sergeant', value: 'E-8 Senior Master Sergeant' },
			{ text: 'E-9 Chief Master Sergeant', value: 'E-9 Chief Master Sergeant' },
			{ text: 'O-1 Second Lieutenant', value: 'O-1 Second Lieutenant' },
			{ text: 'O-2 First Lieutenant', value: 'O-2 First Lieutenant' },
			{ text: 'O-3 Captain', value: 'O-3 Captain' },
			{ text: 'O-4 Major', value: 'O-4 Major' },
			{ text: 'O-5 Lieutenant Colonel', value: 'O-5 Lieutenant Colonel' },
			{ text: 'O-6 Colonel', value: 'O-6 Colonel' },
			{ text: 'O-7 Brigadier General', value: 'O-7 Brigadier General' },
			{ text: 'O-8 Major General', value: 'O-8 Major General' },
			{ text: 'O-9 Lieutenant General', value: 'O-9 Lieutenant General' },
		];
      const majcomOptions = [
        { text: '-- Select Your MAJCOM --', value: '' },
        { text: 'Air Combat Command (ACC)', value: 'Air Combat Command (ACC)' },
        { text: 'Air Education and Training Command (AETC)', value: 'Air Education and Training Command (AETC)' },
        { text: 'Air Force Global Strike Command (AFGSC)', value: 'Air Force Global Strike Command (AFGSC)' },
        { text: 'Air Force Materiel Command (AFMC)', value: 'Air Force Materiel Command (AFMC)' },
        { text: 'Air Force Reserve Command (AFRC)', value: 'Air Force Reserve Command (AFRC)' },
        { text: 'Air Force Special Operations Command (AFSOC)', value: 'Air Force Special Operations Command (AFSOC)' },
        { text: 'Air Mobility Command (AMC)', value: 'Air Mobility Command (AMC)' },
        { text: 'Pacific Air Forces (PACAF)', value: 'Pacific Air Forces (PACAF)' },
        { text: 'U.S. Air Forces in Europe â€“ Air Forces Africa (USAFE-AFAFRICA)', value: 'U.S. Air Forces in Europe â€“ Air Forces Africa (USAFE-AFAFRICA)' },
        { text: 'Air Force Medical Command (AFMEDCOM)', value: 'Air Force Medical Command (AFMEDCOM)' },
        { text: 'Air National Guard Readiness Center (ANGRC)', value: 'Air National Guard Readiness Center (ANGRC)' },
        { text: 'Headquarters Air Force (HAF)', value: 'Headquarters Air Force (HAF)' },
        { text: 'Air Force Southern Command (AFSOUTH)', value: 'Air Force Southern Command (AFSOUTH)' },
        { text: 'U.S. Air Forces Central (AFCENT)', value: 'U.S. Air Forces Central (AFCENT)' },
      ];

      const mgaOptions = [
        { text: '-- Select Major Graded Area --', value: '' },
        { text: 'Executing the Mission', value: 'Executing the Mission' },
        { text: 'Leading People', value: 'Leading People' },
        { text: 'Managing Resources', value: 'Managing Resources' },
        { text: 'Improving the Unit', value: 'Improving the Unit' }
      ];

      const purposeOptions = [
        { text: 'Award Package (AF Form 1206)', value: 'award' },
        { text: 'Enlisted Performance Brief (EPB)', value: 'epr' },
        { text: 'Officer Performance Brief (OPB)', value: 'opr' },
        { text: 'Weekly Civilian Performance', value: 'weekly' }
      ];

      // === Picker/Dropdown Logic ===
      const pickerOverlay = document.getElementById('picker-overlay');
      const pickerOptionsList = document.getElementById('picker-options-list');
      const pickerSearchInput = document.getElementById('picker-search-input');
      
      let pickerState = {
          targetElement: null,
          options: [],
      };

      // --- Mobile Picker Logic (New and Improved) ---
      function openPicker(target, options) {
          pickerState.targetElement = target;
          pickerState.options = options;
          pickerSearchInput.value = '';
          populatePickerOptions(options);
          pickerOverlay.classList.add('visible');
          pickerSearchInput.focus();
      }

      function closePicker() {
          pickerOverlay.classList.remove('visible');
          pickerState.targetElement = null;
      }

      function populatePickerOptions(options) {
          pickerOptionsList.innerHTML = '';
          options.forEach(option => {
              const li = document.createElement('li');
              li.className = 'picker-option-item';
              li.textContent = option.text;
              li.dataset.value = option.value;
              li.addEventListener('click', () => {
                  selectPickerOption(option);
              });
              pickerOptionsList.appendChild(li);
          });
      }

      function selectPickerOption(option) {
          if (pickerState.targetElement) {
              pickerState.targetElement.querySelector('span').textContent = option.text;
              pickerState.targetElement.dataset.value = option.value;
              
              if (pickerState.targetElement.id === 'jobTitle') {
                  document.getElementById('otherJobField').classList.toggle('hidden', option.value !== 'other');
              }
          }
          closePicker();
      }

      pickerSearchInput.addEventListener('input', (e) => {
          const searchTerm = e.target.value.toLowerCase();
          const filteredOptions = pickerState.options.filter(opt => 
              opt.text.toLowerCase().includes(searchTerm)
          );
          populatePickerOptions(filteredOptions);
      });

      // --- Desktop Dropdown Logic ---
      function createCustomDropdown(options, initialValue, id) {
        const initialOption = options.find(opt => opt.value === initialValue) || options[0];
        const dropdown = document.createElement('div');
        dropdown.id = id;
        dropdown.className = 'custom-dropdown';
        dropdown.dataset.value = initialOption.value;
        
        const selectedDisplay = document.createElement('div');
        selectedDisplay.className = 'custom-dropdown-selected';
        selectedDisplay.innerHTML = `<span>${initialOption.text}</span>`;
        
        dropdown.appendChild(selectedDisplay);
        return dropdown;
      }

      function initDesktopDropdown(dropdown, options) {
        dropdown.addEventListener('click', (e) => {
            e.stopPropagation();
            createFloatingDropdown(dropdown, options);
        });
      }

      function createFloatingDropdown(parentDropdown, options) {
          closeAllDropdowns();
          const panel = document.createElement('div');
          panel.id = 'floating-dropdown-panel';
          panel.className = 'floating-dropdown-options';
          
          const searchInput = document.createElement('input');
          searchInput.type = 'text';
          searchInput.placeholder = 'Type to search...';
          searchInput.style.cssText = `
              width: 100%; padding: 0.5rem 0.75rem; border: none; 
              border-bottom: 1px solid var(--border-color); background: transparent; 
              color: var(--text-primary); outline: none; margin-bottom: 0.25rem;
          `;
          panel.appendChild(searchInput);
          
          const optionsContainer = document.createElement('div');
          
          const renderOptions = (filter = '') => {
              optionsContainer.innerHTML = '';
              options
                  .filter(opt => opt.text.toLowerCase().includes(filter.toLowerCase()))
                  .forEach(opt => {
                      const optionEl = document.createElement('div');
                      optionEl.className = 'floating-dropdown-option';
                      optionEl.textContent = opt.text;
                      if (parentDropdown.dataset.value === opt.value) {
                          optionEl.classList.add('selected');
                      }
                      optionEl.addEventListener('click', () => {
                          parentDropdown.dataset.value = opt.value;
                          parentDropdown.querySelector('span').textContent = opt.text;
                          if (parentDropdown.id === 'jobTitle') {
                              document.getElementById('otherJobField').classList.toggle('hidden', opt.value !== 'other');
                          }
                          closeAllDropdowns();
                      });
                      optionsContainer.appendChild(optionEl);
                  });
          };

          searchInput.addEventListener('input', () => renderOptions(searchInput.value));
          panel.appendChild(optionsContainer);
          document.body.appendChild(panel);
          
          const rect = parentDropdown.getBoundingClientRect();
          panel.style.left = `${rect.left}px`;
          panel.style.top = `${rect.bottom + 4}px`;
          panel.style.width = `${rect.width}px`;

          renderOptions();
          searchInput.focus();
          panel.addEventListener('click', e => e.stopPropagation());
      }

      function closeAllDropdowns() {
        const existingPanel = document.getElementById('floating-dropdown-panel');
        if (existingPanel) existingPanel.remove();
      }

      // --- Main Initialization ---
      function createResponsiveSelect(containerId, options, initialValue) {
        const container = document.getElementById(containerId);
        const id = containerId.replace('Container', '');
        
        const initialOption = options.find(opt => opt.value === initialValue) || options[0];
        
        let selectControl;

        if (isTouchDevice) {
            selectControl = document.createElement('div');
            selectControl.id = id;
            selectControl.className = 'custom-picker-input';
            selectControl.dataset.value = initialOption.value;
            selectControl.innerHTML = `<span>${initialOption.text}</span>`;
            selectControl.addEventListener('click', () => openPicker(selectControl, options));
        } else {
            selectControl = createCustomDropdown(options, initialValue, id);
            initDesktopDropdown(selectControl, options);
        }
        
        container.innerHTML = '';
        container.appendChild(selectControl);
      }

      document.addEventListener('DOMContentLoaded', function() {
        // Initialize all dropdowns
        createResponsiveSelect('jobTitleContainer', afscOptions, '');
		createResponsiveSelect('rankContainer', rankOptions, '');
        createResponsiveSelect('majcomContainer', majcomOptions, '');
        createResponsiveSelect('mgaContainer', mgaOptions, '');
        createResponsiveSelect('purposeContainer', purposeOptions, 'award');
        
        const confirmModal = document.getElementById('confirmation-modal');
        const alertModal = document.getElementById('alert-modal');
        const resetBtn = document.getElementById('resetBtn');
        const cancelBtn = document.getElementById('cancel-reset');
        const confirmBtn = document.getElementById('confirm-reset');
        const alertOkBtn = document.getElementById('alert-ok');
        const themeToggleBtn = document.getElementById('theme-toggle');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');

        // --- Theme Switcher Logic ---
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            sunIcon.style.display = theme === 'dark' ? 'block' : 'none';
            moonIcon.style.display = theme === 'light' ? 'block' : 'none';
        }

        const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        applyTheme(savedTheme);

        themeToggleBtn.addEventListener('click', () => {
            const newTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        });

        // Toggle "How to Use This Tool" section
        document.getElementById('howToUseToggle').addEventListener('click', function() {
            const howToUseBody = document.getElementById('howToUseBody');
            howToUseBody.classList.toggle('hidden');
            this.textContent = howToUseBody.classList.contains('hidden') ? 'â“˜ Show Instructions' : 'âœ• Hide Instructions';
        });

        // Toggle reference section
        document.getElementById('toggleReference').addEventListener('click', function() {
            const referenceSection = document.getElementById('referenceSection');
            referenceSection.classList.toggle('hidden');
            this.textContent = referenceSection.classList.contains('hidden') ? 'â“˜ Show Guidance' : 'âœ• Hide Guidance';
        });

        // Toggle ALQ descriptions
        document.getElementById('toggleAlqDescriptions').addEventListener('click', function() {
            const alqDescriptions = document.getElementById('alqDescriptions');
            alqDescriptions.classList.toggle('hidden');
            this.textContent = alqDescriptions.classList.contains('hidden') ? 'â“˜ Show ALQ Descriptions' : 'âœ• Hide ALQ Descriptions';
        });
		
		// --- Character Counter Logic ---
        const charCounterTextBox = document.getElementById('charCounterTextBox');
        const charCounterCount = document.getElementById('charCounterCount');

        if (charCounterTextBox && charCounterCount) {
            charCounterTextBox.addEventListener('input', () => {
                const count = charCounterTextBox.value.length;
                charCounterCount.textContent = count;
                // Change color based on common performance statement lengths
                if (count > 250) {
                    charCounterCount.style.color = 'var(--danger-color)';
                } else if (count > 175) {
                     charCounterCount.style.color = '#f59e0b'; /* Amber color for warning */
                } else {
                    charCounterCount.style.color = 'var(--primary-cyan)';
                }
            });
        }
		
        // ALQ checkbox handling with max 3 selections
        let selectedAlqsOrder = [];
        document.querySelectorAll('.alq-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const id = this.id;
                selectedAlqsOrder = selectedAlqsOrder.filter(item => item !== id);
                if (this.checked) {
                    selectedAlqsOrder.push(id);
                    if (selectedAlqsOrder.length > 3) {
                        const oldestId = selectedAlqsOrder.shift();
                        document.getElementById(oldestId).checked = false;
                    }
                }
            });
        });
        
        // START: Modified JavaScript for Generate Button
        document.getElementById('generateButton').addEventListener('click', function() {
            const getElValue = (id) => document.getElementById(id)?.dataset.value || '';
            const isInteractive = document.getElementById('interactiveModeToggle').checked;

            let jobTitle = getElValue('jobTitle');
            if (jobTitle === 'other') {
                jobTitle = document.getElementById('otherJobTitle').value.trim() || 'Unspecified Job Title';
            }

            const selectedMajcom = getElValue('majcom');
            const selectedMGA = getElValue('mga');
            const accomplishment = document.getElementById('accomplishment').value.trim();
            const purpose = getElValue('purpose');
            const selectedRank = getElValue('rank'); // FIXED: Added this missing variable declaration

            let prompt = '';

            if (isInteractive) {
                // FIXED: Removed the outer '{' and '}' from the acronym list to make it valid text within the string.
                prompt = `You are to assume the persona of a seasoned USAF Chief Master Sergeant with extensive experience on promotion boards. Your designation is "Performance Statement Expert." Your primary mission is to assist me, a ${selectedRank} serving as a ${jobTitle}, in preparing a performance statement for my evaluation. This statement is for the ${selectedMGA} section and must reflect my readiness for promotion.

Your expertise will be guided by the following specific parameters and documents if I have uploaded them:

USAF Writing Guide: The core principles of Air Force writing standards, focusing on the "Action, Impact, Result" (A-I-R) or "Accomplishment/Impact" format. Brevity, clarity, and active voice are paramount.

Statements must reflect the expected level of leadership, mentorship, resource management, and strategic perspective.

You may ask the me to upload previous statements or example statements to help you refine the statements. 

Unit & Command Context:

MAJCOM: ${selectedMajcom}

Approved Acronyms: You must strictly adhere to the following list of approved acronyms and avoid any not on this list: 

Common ranks/tiers across all services (SrA, Maj, Brig Gen, SNCO, etc...)
Common office symbols (CC, CMSAF, A4, JA, etcâ€¦)
Common organizations at squadron and above (CPTS, AFGSC, DoD, FBI, STARCOM, CCMD, FW, CJTF, etc...)
Common weapons and platforms (F-16, AIM-9, HH-60, MILSTAR, etcâ€¦)
Common symbols and measurements (lbs, MPH, $25B, 5%, hrs, FY23, etcâ€¦)

The only other acronyms allowed are the following:

  "ABM": "AIR BATTLE MANAGER",
  "ACE": "AGILE COMBAT EMPLOYMENT",
  "AD": "ACTIVE DUTY",
  "ADCON": "ADMINISTRATIVE CONTROL",
  "AFE": "AIRCREW FLIGHT EQUIPMENT",
  "AFFORGEN": "AIR FORCE FORCE GENERATION",
  "AFI": "AIR FORCE INSTRUCTION",
  "AFMAN": "AIR FORCE MANUAL",
  "AFSC": "AIR FORCE SPECIALTY CODE",
  "AFSO21": "AIR FORCE SMART OPERATIONS FOR THE 21ST CENTURY",
  "AGE": "AEROSPACE GROUND EQUIPMENT",
  "AGR": "ACTIVE GUARD RESERVE",
  "AI": "ARTIFICIAL INTELLIGENCE",
  "ALQ": "AIRMAN LEADERSHIP QUALITY",
  "ALS": "AIRMAN LEADERSHIP SCHOOL",
  "AOC": "AIR OPERATIONS CENTER",
  "AOR": "AREA OF RESPONSIBILITY",
  "APF": "APPROPRIATED FUNDS",
  "ART": "AIR RESERVE TECHNICIAN",
  "AT": "ANNUAL TOUR",
  "ATC": "AIR TRAFFIC CONTROL",
  "ATO": "AIR TASKING ORDER",
  "BMT": "BASIC MILITARY TRAINING",
  "BNR": "BY NAME REQUEST",
  "BTZ": "BELOW-THE-ZONE",
  "C2": "COMMAND AND CONTROL",
  "C4ISR": "COMMAND, CONTROL, COMMUNICATIONS, COMPUTERS, INTELLIGENCE, SURVEILLANCE AND RECONNAISSANCE",
  "CAOC": "COMBINED AIR OPERATIONS CENTER",
  "CAS": "CLOSE AIR SUPPORT",
  "CAT": "CRISIS ACTION TEAM",
  "CATM": "COMBAT ARMS TRAINING AND MAINTENANCE",
  "CBRN": "CHEMICAL, BIOLOGICAL, RADIOLOGICAL, NUCLEAR",
  "CBT": "COMPUTER BASED TRAINING",
  "CCAF": "COMMUNITY COLLEGE OF THE AIR FORCE",
  "CCIP": "COMMANDER'S INSPECTION PROGRAM",
  "CDI": "COMMANDER DIRECTED INVESTIGATION",
  "CFETP": "CAREER FIELD EDUCATION AND TRAINING PLAN",
  "CFM": "CAREER FIELD MANAGER",
  "CLA": "CHIEF MASTER SERGEANT LEADERSHIP ACADEMY",
  "CLC": "CHIEF MASTER SERGEANT LEADERSHIP COURSE",
  "COA": "COURSE OF ACTION",
  "CODEL": "CONGRESSIONAL DELEGATION",
  "CONOPS": "CONCEPT OF OPERATIONS",
  "CONUS": "CONTINENTAL UNITED STATES",
  "COOP": "CONTINUITY OF OPERATIONS",
  "CPI": "CONTINUOUS PROCESS IMPROVEMENT",
  "CPR": "CARDIOPULMONARY RESUSCITATION",
  "CSAR": "COMBAT SEARCH AND RESCUE",
  "CUI": "CONTROLLED UNCLASSIFIED INFORMATION",
  "DAFI": "DEPARTMENT OF THE AIR FORCE INSTRUCTION",
  "DAFMAN": "DEPARTMENT OF THE AIR FORCE MANUAL",
  "DEOCS": "DEFENSE EQUAL OPPORTUNITY CLIMATE SURVEY",
  "DG": "DISTINGUISHED GRADUATE",
  "DHA": "DEFENSE HEALTH AGENCY",
  "DSG": "DRILL STATUS GUARDSMAN",
  "DV": "DISTINGUISHED VISITOR",
  "EKIA": "ENEMY KILLED IN ACTION",
  "EOC": "EMERGENCY OPERATIONS CENTER",
  "EOD": "EXPLOSIVE ORDNANCE DISPOSAL",
  "EOY": "END OF YEAR",
  "EPB": "ENLISTED PERFORMANCE BRIEF",
  "EW": "ELECTRONIC WARFARE",
  "FAM": "FUNCTIONAL AREA MANAGER",
  "FHP": "FLYING HOUR PROGRAM",
  "FMC": "FULLY MISSION CAPABLE",
  "FOB": "FORWARD OPERATING BASE",
  "FOC": "FULL OPERATIONAL CAPABILITY",
  "FOL": "FORWARD OPERATING LOCATION",
  "FPCON": "FORCE PROTECTION CONDITIONS",
  "FTEC": "FIRST TERM ENLISTED COURSE",
  "FTU": "FORMAL TRAINING UNIT",
  "GPA": "GRADE POINT AVERAGE",
  "GPS": "GLOBAL POSITIONING SYSTEM",
  "GSU": "GEOGRAPHICALLY SEPARATED UNIT",
  "GTC": "GOVERNMENT TRAVEL CARD",
  "IDT": "INACTIVE DUTY TRAINING",
  "IDE": "INTERMEDIATE DEVELOPMENTAL EDUCATION",
  "IED": "IMPROVISED EXPLOSIVE DEVICE",
  "IMA": "INDIVIDUAL MOBILIZATION AUGMENTEE",
  "IOC": "INITIAL OPERATIONAL CAPABILITY",
  "IP": "INSTRUCTOR PILOT",
  "ISR": "INTELLIGENCE, SURVEILLANCE, AND RECONNAISSANCE",
  "IT": "INFORMATION TECHNOLOGY",
  "JADC2": "JOINT ALL DOMAIN COMMAND AND CONTROL",
  "JROTC": "JUNIOR RESERVE OFFICER TRAINING CORPS",
  "KIA": "KILLED IN ACTION",
  "LOE": "LINE OF EFFORT",
  "MCA": "MULTI-CAPABLE AIRMEN",
  "MDS": "MISSION DESIGN SERIES",
  "MILCON": "MILITARY CONSTRUCTION",
  "MILPDS": "MILITARY PERSONNEL DATA SYSTEM",
  "MOA": "MEMORANDUM OF AGREEMENT",
  "MOU": "MEMORANDUM OF UNDERSTANDING",
  "MTF": "MEDICAL TREATMENT FACILITY",
  "MWR": "MORALE, WELFARE, AND RECREATION",
  "MX": "MAINTENANCE",
  "NC3": "NUCLEAR COMMAND, CONTROL, AND COMMUNICATIONS",
  "NCOA": "NONCOMMISSIONED OFFICER ACADEMY",
  "NCR": "NATIONAL CAPITAL REGION",
  "NDAA": "NATIONAL DEFENSE AUTHORIZATION ACT",
  "NDS": "NATIONAL DEFENSE STRATEGY",
  "NEO": "NONCOMBATANT EVACUATION OPERATION",
  "NIPR": "NON-SECURE INTERNET PROTOCOL ROUTER",
  "NMC": "NON MISSION CAPABLE",
  "O&M": "OPERATIONS AND MAINTENANCE",
  "OCO": "OVERSEAS CONTINGENCY OPERATIONS",
  "OCONUS": "OUTSIDE CONTINENTAL UNITED STATES",
  "OJT": "ON THE JOB TRAINING",
  "OPLAN": "OPERATIONS PLAN",
  "OPSEC": "OPERATIONAL SECURITY",
  "OTS": "OFFICER TRAINING SCHOOL",
  "PCS": "PERMANENT CHANGE OF STATION",
  "PDE": "PRIMARY DEVELOPMENTAL EDUCATION",
  "PFA": "PHYSICAL FITNESS ASSESSMENT",
  "PME": "PROFESSIONAL MILITARY EDUCATION",
  "POC": "POINT OF CONTACT",
  "PT": "PHYSICAL TRAINING",
  "QA": "QUALITY ASSURANCE",
  "QoL": "QUALITY OF LIFE",
  "ROE": "RULES OF ENGAGEMENT",
  "ROTC": "RESERVE OFFICER TRAINING CORPS",
  "RPA": "REMOTELY PILOTED AIRCRAFT",
  "SAPR": "SEXUAL ASSAULT PREVENTION AND RESPONSE",
  "SCIF": "SENSITIVE COMPARTMENTED INFORMATION FACILITY",
  "SDE": "SENIOR DEVELOPMENTAL EDUCATION",
  "SERE": "SURVIVAL, EVASION, RESISTANCE, ESCAPE",
  "SIPR": "SECRET INTERNET PROTOCOL ROUTER",
  "SME": "SUBJECT MATTER EXPERT",
  "SNCOA": "SENIOR NONCOMMISSIONED OFFICER ACADEMY",
  "SOF": "SPECIAL OPERATIONS FORCES",
  "SOP": "STANDARD OPERATING PROCEDURES",
  "SOS": "SQUADRON OFFICER SCHOOL",
  "STEM": "SCIENCE, TECHNOLOGY, ENGINEERING, AND MATHEMATICS",
  "TACP": "TACTICAL AIR CONTROL PARTY",
  "TCCC": "TACTICAL COMBAT CASUALTY CARE",
  "TDY": "TEMPORARY DUTY",
  "TFI": "TOTAL FORCE INTEGRATION",
  "TR": "TRADITIONAL RESERVIST",
  "TS": "TOP SECRET",
  "TTP": "TACTICS, TECHNIQUES, AND PROCEDURES",
  "UCI": "UNIT COMPLIANCE INSPECTION",
  "UCMJ": "UNIFORM CODE OF MILITARY JUSTICE",
  "UEI": "UNIT EFFECTIVENESS INSPECTION",
  "UTA": "UNIT TRAINING ASSEMBLY",
  "UTC": "UNIT TYPE CODE",
  "UXO": "UNEXPLODED ORDNANCE",
  "WRM": "WAR RESERVE MATERIEL",
  "XAB": "EXPEDITIONARY AIRBASE"


Your Process:

Acknowledge and Internalize: First, confirm you have assimilated the principles from these guides and fully understand your role as a Performance Statement Expert. Acknowledge my rank, my target promotion rank, and the Major Graded Area of focus.

Initiate Dialogue: Once you are ready, prompt me to provide my accomplishment for the ${selectedMGA} bullet.

Probe for Details (Crucial Step): Do not accept my initial input at face value. Your most important task is to ask probing, clarifying questions to uncover the details needed for a high-impact statement. You must actively seek out:

Quantifiable Data: Ask for numbers (e.g., "How many personnel were trained?", "What was the dollar value of the equipment saved?", "By what percentage did you improve efficiency?").

Scope of Impact: Determine the breadth of the accomplishment (e.g., "Was this a workcenter, squadron, or wing-level initiative?", "Did this program get adopted by the MAJCOM?").

Leadership & Mentorship: Inquire about my specific role in leading and developing others (e.g., "Who did you lead in this project?", "Did you mentor any Airmen to achieve awards or skill-level upgrades?").

Strategic Relevance: Connect the action to the larger mission (e.g., "How did this effort support the Commander's priorities, the Squadron's mission, or align with the goals of [User's MAJCOM]?").

Your goal is to transform my basic inputs into a powerful, concise, and promotion-worthy performance statement that clearly demonstrates my readiness for the responsibilities of a [Target Promotion Rank].

Please start a conversation with me. My raw accomplishment details are below.

My Accomplishment:
${accomplishment}

Based on this, ask me your first question to help me identify the primary ACTION I took. After I answer, continue asking questions one by one to uncover the quantifiable IMPACT of my action, and finally, how that impact ties to the mission. You may provide a DRAFT statement at first but emphasize it is what it could look like and requires refinement. 

Begin now by introducing yourself and asking your first question.`;
            
            } else {
                // This is the original logic for non-interactive mode
                if (!jobTitle || !selectedMajcom || !selectedMGA || !accomplishment) {
                    alertModal.classList.add('visible');
                    return;
                }

                const selectedAlqs = Array.from(document.querySelectorAll('input[name="alq"]:checked')).map(cb => cb.value);
                let alqSection = selectedAlqs.length > 0 ? 'Airman Leadership Qualities (ALQs) to highlight:\n' + selectedAlqs.join(', ') + '\n\n' : '';

                const commonInstructions = `You are a USAF writing assistant specializing in crafting effective performance statements.

Job Title/AFSC: ${jobTitle}
MAJCOM: ${selectedMajcom}
Major Graded Area (MGA): ${selectedMGA}

My accomplishment:
${accomplishment}

${alqSection}Please convert this into 5-7 proper USAF Performance Statements following these guidelines:
- Each statement is a standalone sentence.
- Include an action and at least one impact or result.
- The impact must relate to the MAJCOM's mission and the selected MGA.
- Use plain language and avoid uncommon acronyms.
- Emphasize leadership, mission impact, and quantifiable results.`;

                switch(purpose) {
                    case 'weekly':
                        prompt = `${commonInstructions}\n\nPlease create 5-7 performance statements suitable for a Weekly Civilian Performance report that highlights my most significant contributions this week. Focus on mission impact and demonstrate impact appropriate for the employee's position.\n\nIMPORTANT: Each statement MUST be EXACTLY 250 characters long (including spaces and punctuation). Provide only the formatted statements.`;
                        break;
                    case 'award':
                        prompt = `${commonInstructions}\n\nPlease create 5-7 performance statements suitable for an AF Form 1206 Award Package. Statements should be impactful, showcase leadership, and emphasize quantifiable results.\n\nIMPORTANT: Each statement MUST be EXACTLY 250 characters long (including spaces and punctuation). Provide only the formatted statements.`;
                        break;
                    case 'epr':
                        prompt = `${commonInstructions}\n\nPlease create 5-7 performance statements suitable for an Enlisted Performance Brief (EPB). Focus on duty performance, leadership/followership, and whole airman concept.\n\nIMPORTANT: Each statement MUST be EXACTLY 175 characters long (including spaces and punctuation). Provide only the formatted statements.`;
                        break;
                    case 'opr':
                        prompt = `${commonInstructions}\n\nPlease create 5-7 performance statements suitable for an Officer Performance Brief (OPB). Focus on leadership, mission accomplishment, and professional qualities.\n\nIMPORTANT: Each statement MUST be EXACTLY 175 characters long (including spaces and punctuation). Provide only the formatted statements.`;
                        break;
                }
            }

            // The following line can be uncommented for debugging purposes
            // document.getElementById('outputContainer').classList.remove('hidden');
            // document.getElementById('outputPrompt').textContent = prompt;
            
			
			// --- 3. Copy to Clipboard and Update UI ---

			const tempTextArea = document.createElement("textarea");
			tempTextArea.value = prompt;
			document.body.appendChild(tempTextArea);
			tempTextArea.select();
			document.execCommand("copy");
			document.body.removeChild(tempTextArea);
		
			const generateButton = this;
			generateButton.textContent = 'Copied!';
			setTimeout(() => {
				generateButton.textContent = 'Generate & Copy Prompt';
			}, 2000);

			// Scroll to AI resources
			document.getElementById('aiResourcesCard').scrollIntoView({
				behavior: 'smooth',
				block: 'center'
			});
		});

        // START: Modified JavaScript for Reset Logic
        resetBtn.addEventListener('click', () => confirmModal.classList.add('visible'));
        cancelBtn.addEventListener('click', () => confirmModal.classList.remove('visible'));
        confirmBtn.addEventListener('click', () => {
            // Reset dropdowns
            createResponsiveSelect('jobTitleContainer', afscOptions, '');
            createResponsiveSelect('majcomContainer', majcomOptions, '');
            createResponsiveSelect('mgaContainer', mgaOptions, '');
            createResponsiveSelect('purposeContainer', purposeOptions, 'award');
            
            // Clear other fields
            document.getElementById('otherJobField').classList.add('hidden');
            document.getElementById('otherJobTitle').value = '';
            document.getElementById('accomplishment').value = '';
            document.querySelectorAll('.alq-checkbox').forEach(cb => cb.checked = false);
            selectedAlqsOrder = [];
            
            // Reset the interactive mode toggle
            document.getElementById('interactiveModeToggle').checked = false;

            // Hide output
            document.getElementById('outputContainer').classList.add('hidden');
            document.getElementById('outputPrompt').textContent = '';
            
            // Close modal
            confirmModal.classList.remove('visible');
        });
        // END: Modified JavaScript

        confirmModal.addEventListener('click', (e) => {
            if (e.target === confirmModal) confirmModal.classList.remove('visible');
        });

        // --- Alert Modal Logic ---
        alertOkBtn.addEventListener('click', () => alertModal.classList.remove('visible'));
        alertModal.addEventListener('click', (e) => {
            if (e.target === alertModal) alertModal.classList.remove('visible');
        });

        // Global click listener to close dropdowns/pickers
        window.addEventListener('click', () => {
            if (!isTouchDevice) {
                closeAllDropdowns();
            }
        });
        pickerOverlay.addEventListener('click', (e) => {
            if (e.target === pickerOverlay) {
                closePicker();
            }
        });
      });
    </script>
</body>
</html>
